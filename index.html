<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>reAlBhed - Realtime Al Bhed Translator</title>
  <link href='http://fonts.googleapis.com/css?family=Sonsie+One|Arapey' rel='stylesheet' type='text/css'>
  <link href="style.css" rel="stylesheet">
  <script>
    window.onload = function() {
      var input  = document.getElementById("input");
      var output = document.getElementById("output");
      var engbutton = document.getElementById("english");
      var albutton = document.getElementById("alBhed");
      var title = document.getElementById("title");
      var subtitle = document.getElementById("subtitle");
      var engalpha = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWQYZ";
      var albalpha = "ypltavkrezgmshubxncdijfqowYPLTAVKREZGMSHUBXNCDIJFXOW";

      //focus on textbox on load
      input.focus();

      //english to al bhed translation function
      function translate(stringin, from) {
        var stringout = "";
        var flag = new Boolean(true);
        //for each item in the input string
        for (var i = 0; i < stringin.length; i++) {
          //check if it's an english letter
          if (engalpha.indexOf(stringin[i]) == -1) {
            //if not alpha, check whether to start ignoring translation
            if (stringin[i] == '[') {
              flag = false;
            //or stop ignoring translation
            } else if (stringin[i] == ']') {
              flag = true;
            //otherwise, add the non-alpha character to the output string
            } else {
              stringout = stringout + stringin[i];
            }
          //if alpha, check whether translation is being ignored
          } else if (flag == false) {
            //add character without translation if it is 
            stringout = stringout + stringin[i];
          } else {
            //or translate, then add if it isn't
            if (from == "english") {
              stringout = stringout + albalpha.charAt(engalpha.indexOf(stringin[i]));
            } else if (from == "alBhed") {
              stringout = stringout + engalpha.charAt(albalpha.indexOf(stringin[i]));
            }
          }
        }
        return stringout;
      }

      //at the end of each keypress
      input.onkeyup = function() {
        //check which translation mode is selected, and translate
        if (engbutton.checked) {
          output.innerHTML = translate(input.value, "english");
        } else if (albutton.checked) {
          output.innerHTML = translate(input.value, "alBhed");
        } 
      }

      //retranslate on radio button click, and change set text for effect
      engbutton.onclick = function() {
        output.innerHTML = translate(input.value, "english");
        title.innerHTML = "reAlBhed - Realtime Al Bhed Translator";
        subtitle.innerHTML = "Use square brackets to [stop translation]";
      }
      albutton.onclick = function() {
        output.innerHTML = translate(input.value, "alBhed");
        title.innerHTML = "reAlBhed - Naymdesa Al Bhed Dnyhcmydun";
        subtitle.innerHTML = "Ica cxiyna pnylgadc du [stop translation]";
      }
    };
  </script>
</head>
<body>
  <div class="container">
    <h1 id="title">reAlBhed - Realtime Al Bhed Translator</h1>
    <h2 id="subtitle">Use square brackets to [stop translation]</h2>
    <textarea id="input" class="box"></textarea><br>
    <input type="radio" name="language" id="english" value="English -> Al Bhed" checked>
    <label for="english"><span></span>English -> Al Bhed</label>
    <input type="radio" name="language" id="alBhed" value="Al Bhed -> English">
    <label for="alBhed"><span></span>Al Bhed -> English</label><br>
    <p id="output" class="box"></p>
  </div>
</body>
</html>